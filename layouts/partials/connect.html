{{ $scratch := .Scratch }}
{{ $socialsMap := .CurrentSection.Param "connections" -}}
{{ $socialsParentMap := .CurrentSection.Parent.Param "connections" }}
{{ $socialsConfigMap := .Site.Params.connectionOptions }}

{{ $mapRegister := 0 }}
{{ if reflect.IsMap $socialsMap }}
{{ $mapRegister = add $mapRegister 1 }}
{{ end }}
{{ if reflect.IsMap $socialsParentMap }}
{{ $mapRegister = add $mapRegister 10 }}
{{ end }}
{{ if reflect.IsMap $socialsConfigMap }}
{{ $mapRegister = add $mapRegister 100 }}
{{ end }}

<p>Map Register: {{ $mapRegister }}</p>

{{ range $key, $value := $socialsMap }}
{{ $scratch.Add "socials" (slice $key) }}
{{ end }}
{{ $scratch.Set "socials" (uniq ($scratch.Get "socials")) }}

{{ range $key, $value := $socialsParentMap }}
{{ $scratch.Add "socialsAggregate" (slice $key) }}
{{ end }}
{{ $scratch.Set "socialsAggregate" (( uniq ($scratch.Get "socialsAggregate")) | complement ($scratch.Get "socials")) }}

{{ range $key, $value := $socialsConfigMap }}
{{ $scratch.Add "socialsSite" (slice $key) }}
{{ end }}
{{ $scratch.Set "socialsSite" (( uniq ($scratch.Get "socialsSite")) | complement ($scratch.Get "socials") ($scratch.Get "socialsAggregate")) }}

{{- $social := "" -}}
{{- if ne $social "" -}}
	<a href="{{ .url }}">
		<div class="connect-option">
			{{- .svg | safeHTML -}}
			<p>{{ .name }}</p>
		</div>
	</a>
{{- end -}}